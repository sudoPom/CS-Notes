`tags:` [[Denial-of-Service]]

# Malware
`Malware` is a piece of software that is written to cause some unwanted and malicious activity on a host device.

### Motivation
As time went on the motivation of producing malware changed from:
* Seeming cool and having fun
* Vandalism
* Stealing information, Control machines for DDoS/Spam and making moeny

Countering malware requires solutions that makes an attack require an unfeasible amount of effort/resources.

## Virus
A `virus` ia a type of malware that can modify exisiting programs to include another (possibly upgraded) version of itself. They can:
* Reproduce it's own code
* Attatch itself to other files
* Get executed when the infected executable is executed

Viruses can effect 

* Files:
	* `Overwrite viruses` replaces the original program
	* `Parasitic viruses` appends the viral program to the original program and then change the entry point of the program to where the code for the viral program is.
	* `Cavity viruses` install within the infected file by inserting code into gaps in the binary of the original program 
* Macros:
	* A `macro` is a script that is automatically executed when something is loaded.
* Bootup
	The master boot record is a section of the hard disk that stores instructions that boot up your system.

### Virus Defense
`Antivirus software` helps defend against viruses. Signature based detection software has a database of signatures (patterns) that match known viruses, these include hashes of known malicious programs. Whilst heuristics based software checks for patterns such as:
* Code execution that starts in last section
* Incorrect header size in PE header
* Suspicious code section name
* Patched import address table.

`Sandboxing` Involves running untrusted applications in a restricted environment to see its behaviour.

## Worms
`Worms` are self replecating computer programs that use a network to send copies of itself to other devices.

Worms can:
* Spread across a network on their own
* Does not require a file to be attatched to
* Rate of spread may increase over time

Worms can be propogated by mail (using social engineering techniques) or an exploit which spreads on its own, exploit based propogation is much faster in spreading as it requires no human interaction. The only thing that limits the speed is network bandwidth and latency.

### Worm Defense

#### Host Level Defence
Virus scanners can be effective against email based worms but once the worm is on the system and executed by the user they aren't as useful. This is an example of a host level defence, as it protects a single node on the network. More examples include:
* Stack protection techniques
* Address Space Layout randomisation
However this type of defence is not useful if the user just executes the malware.

#### Network Level Defence 
The network that the worms operated can be protected by detecting known malicious behaviour, limiting the number of connections or by blocking outgoing SMTP connections from unknown applications.

## Trojan Horse 
A `trojan horse` is a type of malware that appears to perform well but also perform undisclosed malicious activities.

Trojan Horses:

* Require the user to explicitly run the program
* Cannot replicate
* Can perform any type of malicious activity (without attatching to a file)

Trojan horses typically enter a system by social engineering.

## Spyware
`Spyware` is a piece of software that monitors the behaviour of the victim and collects information without the users knowledge.

They are:
* A threat to user privacy
* Hidden from the user and hard to detect 
* Leak sensitive information
* Often implemented in browser plugins or extensions.

## Keyloggers
`Keyloggers` record keystrokes that are typed by the user, typically to capture user data such as passwords and bank details. They are easy to write and difficult to recognise by antivirus scanners.

## Rootkit
A `rootkit` disguises the exsistence of a malicious program in a system but allows privilege access to it. They can:

* Be installed by an attacker after a system has been compromised
* Hide the presence of the attacker and allows him to return at a later time
* Hard to detect.

### Kernel Rootkits
`Kernel rootkits` modify the kernel which can hide processes, files and network activities.

### Rootkit Defense
#### User Space
* Tripwires and Chkrootkit
#### Kernel Space
* Kernel Security Therapy Anti-Trolls (KSTAT) 