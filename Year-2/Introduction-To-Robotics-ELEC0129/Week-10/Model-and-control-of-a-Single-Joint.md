# Model of a single Joint
To control a joint it first needs to be modelled. A joint consists of two parts:
* Electrical (DC Motor)
* Mechanical (Shaft, gear, load)

These parts are not independent of each other, the electrical part of the joint causes a torque for the mechanical part, whilst the mechanical part provides a back EMF force to the electrical part.

Meaning the torque generated by the motor is proportional to the armature current:
![[Pasted image 20220506035103.png]]
Where $k_m$ is the torque constant of the motor.

And the back EMF is proportional to the rotor speed:
![[Pasted image 20220506035212.png]]

Where $k_e$ is the electric constant of the motor.

#### Electrical side dynamics

The electrical circuit equation for the circuit:
![[Pasted image 20220506035417.png]]

is:
![[Pasted image 20220506035433.png]]

However it is assumed that Inductance $L_a$ is negligible meaning, after substituting $V_{emf}$ the equation becomes:
![[Pasted image 20220506035527.png]]

#### Mechanical side Dynamics
The equation for the free body diagram:

![[Pasted image 20220506035924.png]]

The motor side dynamics is:

![[Pasted image 20220506040649.png]]

And the load side dynamics is:

![[Pasted image 20220506040321.png]]

Letting $\tau = Fr_2$ (3)

The load side dynamics becomes:

![[Pasted image 20220506040409.png]]

Meaning:
![[Pasted image 20220506040628.png]]

Re arranging equation 3 gives:
![[Pasted image 20220506040726.png]]

Allowing equation 1 to be written as 

![[Pasted image 20220506040840.png]]

and combining equation 4 and 5 gives:
![[Pasted image 20220506040905.png]]

The goal is to express everything in terms of load side terms as the load is the gear which interacts with the outside world.

Let $\eta$ be the ratio between the two gears:
![[Pasted image 20220506041115.png]]

The gear ratio increases the torque experienced at the load but reduces the speed of the load.
![[Pasted image 20220506041250.png]]

Lastly substituting equations 7, 8 and 9 into 6 gives us:

![[Pasted image 20220506041417.png]]

Which is of the form of the [[Control#Natural System|Natural system]] allowing it to be used for control design.

## Control of a single joint
The same control partitioning technique can be used to control the joint:
* Design the model based control:
![[Pasted image 20220506041839.png]]
* Design the servo controller:
![[Pasted image 20220506041916.png]]
* Set the desired stiffness $k_p$
* Then set $k_v=2\sqrt{k_p}$

The control system computes the torque required on the load side. To compute the torque required by the motor we can convert it using $\eta$:
![[Pasted image 20220506042139.png]]

This motor torque can be calculated by controlling the current:
![[Pasted image 20220506042223.png]]

Which can be achieved by varying the voltage:
![[Pasted image 20220506042309.png]]

